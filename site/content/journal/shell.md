+++
date = '2025-05-21T14:00:00+03:00'
draft = false
title = 'Разработка интерпретатора командной строки на языке C'
+++

Для лучшего понимания принципов системного программирования и взаимодействия с ОС на низком уровне мы разработали собственную оболочку командной строки (shell) на языке C. Основная цель — реализовать минимальный интерпретатор, способный обрабатывать пользовательские команды, выполнять внешние программы, а также поддерживать функциональность перенаправления ввода/вывода и использование пайпов. Это позволяет продемонстрировать ключевые аспекты работы процессов в Unix-подобных системах.

Реализация выполнена с использованием стандартных POSIX-функций. Особое внимание уделялось безопасной работе с памятью, корректной обработке ошибок и расширяемости архитектуры.

Ознакомиться с кодом интерпретатора можно в нашем [репозитории](https://github.com/n-hexane/practice-shell/ "Перейти в репозиторий с кодом оболочки").

**Пример работы интерпретатора**
![Интерфейс Shell](/images/shell_prompt.png)

# Введение

Проектная работа включала создание собственной минималистичной оболочки командной строки. Такая оболочка предназначена для считывания пользовательского ввода, разбора и выполнения команд, включая встроенные (например, `cd` и `exit`), а также внешние утилиты ОС.

Мы стремились реализовать следующие ключевые функции:

- чтение строк ввода;
- разбор команд и аргументов;
- выполнение команд с использованием `fork` и `execvp`;
- поддержка перенаправления ввода/вывода (`<`, `>`);
- поддержка пайпов (`|`);
- обработка встроенных команд.

# Описание реализации

## Основные компоненты:

- **Чтение ввода** — используется `getline()` для безопасного считывания строк;
- **Разбор строк** — реализован собственный парсер с разделением по пробелам и символам пайпа;
- **Структура Command** — структура для хранения имени команды и массива аргументов;
- **Перенаправление** — используется `open`, `dup2` и `close` для подмены стандартного ввода/вывода;
- **Пайпы** — команды, разделённые `|`, обрабатываются через `pipe()` и два дочерних процесса.

### Особенности кода

- Встроенные команды `cd` и `exit` обрабатываются непосредственно в основном цикле;
- Все внешние команды исполняются через `fork()` и `execvp()` в дочернем процессе;
- При наличии символов перенаправления `<` и `>`, соответствующие дескрипторы заменяются с помощью `dup2`;
- Для команд с пайпом создаются два дочерних процесса, между которыми устанавливается канал связи через `pipe()`.

Пример использования:

```sh
esd> ls -l > files.txt
esd> cat files.txt | grep main
esd> cd ..
esd> exit
